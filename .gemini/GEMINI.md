# GEMINI Project: Battlezone 2 Strat ELO Ratings

This project was developed to analyze game data from "Battlezone 2", calculate player ELO ratings, and display them in a web application.

## Task Accomplished

The main tasks accomplished in this project are:

1.  **Data Parsing:** A script was created to parse raw game data from a JSON file into a structured format.
2.  **ELO Calculation:** An ELO calculation utility was developed to determine player ratings based on game outcomes. The utility considers commander and thug roles separately, team composition, and faction advantages.
3.  **Static Analysis:** Several scripts were created to perform static analysis on the game data, including calculating faction win rates and analyzing team balance.
4.  **Web Application:** A React web application was built to display the calculated ELO ratings for commanders and thugs. The app is hosted on Firebase Hosting.
5.  **Database Integration:** The calculated ELO ratings are stored in a Firestore database.

## Components

### Data Files (`data/` directory)

*   `games.json`: The main dataset containing raw game data.
*   `sample_games.json`: A smaller subset of the game data for testing purposes.
*   `games.ts`: The parsed and structured game data, generated by `elo-games-parser.ts`.
*   `commander_elos.js`, `thug_elos.js`: Initial ELO ratings for commanders and thugs.
*   `updated_commander_elos.js`, `updated_thug_elos.js`: The recalculated ELO ratings after processing all games.

### Scripts (`scripts/` directory)

*   `elo-games-parser.ts`: Parses raw game data from a JSON file (`games.json` or `sample_games.json`) and creates a structured `games.ts` file.
*   `elo_calculator.ts`: Calculates player ELO ratings based on the games in `games.ts`. It reads initial ELOs, processes all games, and writes the updated ELOs to Firestore.
*   `static_analysis.ts`: Calculates and displays the win rates for each faction matchup.
*   `balance_checker.ts`: Analyzes team balance by counting the number of games with an unequal number of thugs on each team and calculating the win rate for the team with more thugs.
*   `player_analysis.ts`: Provides a detailed analysis of a specific player, including their ELO, win/loss record, and potential reasons for discrepancies between their ELO and win rate.

### Web App (`elo-viewer/` directory)

A React application created with `create-react-app` that displays the commander and thug ELO ratings in sortable tables. The app fetches the ELO data from the Firestore database.

### Firebase Integration

*   **Firestore:** A NoSQL database used to store the calculated ELO ratings for commanders and thugs.
*   **Firebase Hosting:** The React web app is hosted on Firebase Hosting.

## Methodology

### Data Parsing

The `elo-games-parser.ts` script reads the raw JSON data, which is organized by year, month, and day. It iterates through this nested structure, extracts the relevant information for each game, and creates a structured `Game` object. The structured data is then written to `games.ts` as a TypeScript module.

### ELO Calculation

The ELO calculation is performed by the `elo_calculator.ts` script. The core of the ELO calculation is the following formula to determine team strength:

`Team Strength = (Commander ELO * Commander Influence Factor + Average Thug ELO) * Faction Adjustment`

The win probability for Team A ($E_A$) against Team B ($T_B$) is calculated using the logistic function:

$E_A = \frac{1}{1 + 10^{(T_B - T_A) / 400}}$

After each game, the ELO ratings of the players are updated based on the outcome. The ELO update formula is:

*   **Win:** `New ELO = Old ELO + K-Factor * (1 - Win Probability)`
*   **Loss:** `New ELO = Old ELO - K-Factor * Win Probability`

The K-factor determines how much the ELO changes after each game.

### Static Analysis

The static analysis scripts (`static_analysis.ts` and `balance_checker.ts`) read the structured game data from `games.ts` and perform calculations to provide insights into the game data, suchando faction win rates and team balance statistics.

### Web App

The React app in the `elo-viewer` directory fetches the ELO data directly from the Firestore database. It uses the Firebase Web SDK to connect to Firestore and retrieve the `commanders` and `thugs` documents from the `elos` collection. The data is then displayed in sortable tables for easy viewing.

## How to Use

The scripts are located in the `scripts` directory and can be run from there using `ts-node`.

*   **Parse Games:** `ts-node elo-games-parser.ts [input_file.json]`
*   **Calculate ELOs:** `ts-node elo_calculator.ts`
*   **Static Analysis:** `ts-node static_analysis.ts`
*   **Balance Checker:** `ts-node balance_checker.ts`
*   **Player Analysis:** `ts-node player_analysis.ts`

The web app is deployed to Firebase Hosting and can be accessed at [https://elo-bz2.web.app](https://elo-bz2.web.app).
